GlobalNames:
  PlantEquipment:
    OutdoorAirInletNodes: &OutdoorAirInletNodes
      '{} Outdoor Air Inlet Node'
  PlantLoop:
    AvailabilityManagerList: &AvailabilityManagerList
     '{} Availability List'
    CondenserEquipmentList: &CondenserEquipmentList
      '{} All Equipment'
    DemandBypassBranch: &DemandBypassBranch
      '{} Demand Bypass Branch'
    DemandInlet: &DemandInlet
      '{} Demand Inlet'
    DemandInletBranch: &DemandInletBranch
      '{} Demand Inlet Branch'
    DemandMixer: &DemandMixer
      '{} Demand Mixer'
    DemandOutlet: &DemandOutlet
      '{} Demand Outlet'
    DemandOutletBranch: &DemandOutletBranch
      '{} Demand Outlet Branch'
    DemandSplitter: &DemandSplitter
      '{} Demand Splitter'
    DemandSideBranches: &DemandSideBranches
      '{} Demand Side Branches'
    DemandSideConnectors: &DemandSideConnectors
      '{} Demand Side Connectors'
    PlantEquipmentList: &PlantEquipmentList
      '{} All Equipment'
    PlantEquipmentOperation: &PlantEquipmentOperation
      '{} All Hours'
    PlantEquipmentOperationScheme: &PlantEquipmentOperationScheme
      '{} Operation'
    PlantLoop: &PlantLoop
      '{} PlantLoop'
    SupplyBypassBranch: &SupplyBypassBranch
      '{} Supply Bypass Branch'
    SupplyInlet: &SupplyInlet
      '{} Supply Inlet'
    SupplyInletBranch: &SupplyInletBranch
      '{} Supply Inlet Branch'
    SupplyMixer: &SupplyMixer
      '{} Supply Mixer'
    SupplyOutlet: &SupplyOutlet
      '{} Supply Outlet'
    SupplyOutletBranch: &SupplyOutletBranch
      '{} Supply Outlet Branch'
    SupplySideConnectors: &SupplySideConnectors
      '{} Supply Side Connectors'
    SupplySplitter: &SupplySplitter
      '{} Supply Splitter'
    SupplySideBranches: &SupplySideBranches
      '{} Supply Side Branches'
    SupplySetpointNodes: &SupplySetpointNodes
      '{} Supply Setpoint Nodes'
  System:
    AirLoopInlet: &AirLoopInlet
      '{} Air Loop Inlet'
    AvailabilityManagerAssignmentList: &AvailabilityManagerAssignmentList
      '{} Availability Managers'
    BranchList: &BranchList
      '{} Branches'
    ReturnAirOutlet: &ReturnAirOutlet
      '{} Return Air Outlet'
    SupplyPathInlet: &SystemSupplyPathInletName
      '{} Supply Path Inlet'
    MixedAirNodelistName: &SystemMixedAirNodelistName
      '{} Mixed Air Nodes'
    WaterControllers: &AirLoopHVACWaterControllers
      '{} Controllers'
  Zone:
    SupplyInlet: &ZoneSupplyInlet
      '{} Supply Inlet'
    Return: &ZoneReturn
      '{} Return'
    ReturnOutlet: &ZoneReturnOutlet
      '{} Return Outlet'

Objects:
  Common:
    Objects:
      Connectors:
        AirLoop: &ConnectorsAirLoop
          Inlet: air_inlet_node_name
          Outlet: air_outlet_node_name
        General:
          Inlet: inlet_node_name
          Outler: outlet_node_name
        WaterLoop: &ConnectorsWaterLoop
          Inlet: water_inlet_node_name
          Outlet: water_outlet_node_name
      Schedule:
        Compact:
          ALWAYS_VAL:
            name: 'HVACTemplate-Always{}'
            schedule_type_limits_name: Any Number
            data:
              - field: Through 12/31
              - field: For AllDays
              - field: Until 24:00
              - field: '{:.1f}'
  AirLoopHVAC:
    Base:
      Fields: &AirLoopHVAC
        name: '{}'
        availability_manager_list_name: *AvailabilityManagerAssignmentList
        branch_list_name: *BranchList
        controller_list_name: *AirLoopHVACWaterControllers
        demand_side_inlet_node_names: *SystemSupplyPathInletName
        demand_side_outlet_node_name: *ReturnAirOutlet
        design_supply_air_flow_rate: Autosize # template default, not object default
        supply_side_inlet_node_name: *AirLoopInlet
        supply_side_outlet_node_names:
          BuildPathReference:
            Location: -1
            ValueLocation: Outlet
  AirTerminal:
    Common:
      Transitions: &AirTerminalCommonTransitions
        - AirTerminal:.*:
            supply_air_maximum_flow_rate: maximum_air_flow_rate
            damper_heating_action: damper_heating_action
    SingleDuct:
      Fields: &AirTerminalSingleDuctFields
        air_inlet_node_name: '{} Zone Equip Inlet' # required by schema
        air_outlet_node_name: *ZoneSupplyInlet # required by schema
        constant_minimum_air_flow_fraction: '{constant_minimum_air_flow_fraction}'
        maximum_air_flow_rate: Autosize # required by schema, no default
      VAV:
        Reheat:
          Base:
            - AirTerminal:SingleDuct:VAV:Reheat: &AirTerminalSingleDuctVAVReheat
                name: '{} VAV Reheat'
                <<: *AirTerminalSingleDuctFields
                damper_air_outlet_node_name: '{} Damper Outlet' # required by schema
                damper_heating_action: Reverse # template default, not object default
                reheat_coil_name: # required by schema
                  Coil:Heating:.*: key
          HotWater: &AirTerminalSingleDuctVAVReheatHotWater
            - AirTerminal:SingleDuct:VAV:Reheat:
                <<: *AirTerminalSingleDuctVAVReheat
                constant_minimum_air_flow_fraction: '{constant_minimum_air_flow_fraction}'
                fixed_minimum_air_flow_rate: '{fixed_minimum_air_flow_rate}'
                reheat_coil_object_type: # required by schema
                  Coil:Heating:.*: self
                maximum_air_flow_rate: '{supply_air_maximum_flow_rate}'
                maximum_hot_water_or_steam_flow_rate: Autosize # set by legacy, no default, not reachable from template
                minimum_air_flow_fraction_schedule_name: '{minimum_air_flow_fraction_schedule_name}'
                zone_minimum_air_flow_input_method: '{zone_minimum_air_flow_input_method}'
  AvailabilityManager:
    NightCycle:
      Base:
        Fields: &AvailabilityManagerNightCycle
          name: '{} Availability'
          applicability_schedule_name: HVACTemplate-Always1 # required by schema, not reachable by template, no object default
          control_type: '{night_cycle_control}'
          control_zone_or_zone_list_name: '{night_cycle_control_zone_name}'
          cycling_run_time: 3600 # Indicated to be default, but comparison fails unless explicit
          cycling_run_time_control_type: FixedRunTime # Indicated to be default, but comparison fails unless explicit
          fan_schedule_name: '{system_availability_schedule_name}' # required by schema
          thermostat_tolerance: 0.2 # set by legacy, not template default, not object default
  Boiler:
    CommonObjects:
      - Branch: &BoilerBranch
          name: '{} Branch'
          components:
            - component_object_type:
                Boiler.*: self
              component_name:
                Boiler.*: key
              component_inlet_node_name:
                Boiler.*: boiler_water_inlet_node_name
              component_outlet_node_name:
                Boiler.*: boiler_water_outlet_node_name
    HotWater:
      Common:
        Objects: &BoilerHotWaterCommonObjects
          - Curve:Quadratic:
              name: '{} Efficiency Curve'
              coefficient1_constant: 0.97
              coefficient2_x: 0.0633
              coefficient3_x_2: -0.0333
              maximum_value_of_x: 1.0
              minimum_value_of_x: 0.0
        Transitions: &BoilerHotWaterCommonTransitions
          - Boiler:.*:
              capacity: nominal_capacity
              maximum_part_load_ratio: maximum_part_load_ratio
      Base:
        Fields: &BoilerHotWaterFields
          name: '{}'
          boiler_water_inlet_node_name: '{} HW Inlet' # required by schema
          boiler_water_outlet_node_name: '{} HW Outlet' # required by schema
          boiler_flow_mode: ConstantFlow # set by legacy, not reachable by template, not object default
          efficiency_curve_temperature_evaluation_variable: LeavingBoiler # set by legacy, no default
          fuel_type: '{fuel_type}' # required by schema
          minimum_part_load_ratio: '{minimum_part_load_ratio}'
          maximum_part_load_ratio: 1.1 # template default, not object default
          nominal_thermal_efficiency: '{efficiency}' # required by schema
          nominal_capacity: Autosize # template default
          normalized_boiler_efficiency_curve_name: '{} Efficiency Curve'
          optimum_part_load_ratio: '{optimum_part_load_ratio}'
          sizing_factor: '{sizing_factor}'
          water_outlet_upper_temperature_limit: '{water_outlet_upper_temperature_limit}'
  Chiller:
    Electric:
      Common:
        Objects: &ChillerElectricCommonObjects
          - Branch:
              name: '{} ChW Branch'
              components:
                - component_object_type:
                    Chiller.*: self
                  component_name:
                    Chiller.*: key
                  component_inlet_node_name:
                    Chiller.*: chilled_water_inlet_node_name
                  component_outlet_node_name:
                    Chiller.*: chilled_water_outlet_node_name
      EIR:
        Common:
          Objects: &ChillerElectricEIRCommonObjects
            - Curve:Quadratic:
                name: '{} RecipEIRFPLR'
                coefficient1_constant: 0.088065
                coefficient2_x: 1.137742
                coefficient3_x_2: -0.225806
                maximum_value_of_x: 1
                minimum_value_of_x: 0
            - Curve:Biquadratic:
                name: '{} RecipCapFT'
                coefficient1_constant: 0.507883
                coefficient2_x: 0.145228
                coefficient3_x_2: -0.00625644
                coefficient4_y: -0.0011178
                coefficient5_y_2: -0.0001296
                coefficient6_x_y: -0.00028188
                maximum_value_of_x: 10
                maximum_value_of_y: 35
                minimum_value_of_x: 5
                minimum_value_of_y: 24
            - Curve:Biquadratic:
                name: '{} RecipEIRFT'
                coefficient1_constant: 1.03076
                coefficient2_x: -0.103536
                coefficient3_x_2: 0.00710208
                coefficient4_y: 0.0093186
                coefficient5_y_2: 0.00031752
                coefficient6_x_y: -0.00104328
                maximum_value_of_x: 10
                maximum_value_of_y: 35
                minimum_value_of_x: 5
                minimum_value_of_y: 24
          Transitions: &ChillerElectricEIRCommonTransitions
            - Chiller:.*:
                leaving_chilled_water_lower_temperature_limit: leaving_chilled_water_lower_temperature_limit
                minimum_part_load_ratio: minimum_part_load_ratio
                minimum_unloading_ratio: minimum_unloading_ratio
                optimum_part_load_ratio: optimum_part_load_ratio
        Base: &ChillerElectricEIRSuperObject
          Fields:
            name: '{}'
            chilled_water_inlet_node_name: '{} Chiller ChW Inlet' # required by schema
            chilled_water_outlet_node_name: '{} Chiller ChW Outlet' # required by schema
            condenser_inlet_node_name: '{} Chiller Cnd Inlet'
            condenser_outlet_node_name: '{} Chiller Cnd Outlet'
            chiller_flow_mode: ConstantFlow # set by legacy, not reachable by template, not object default
            condenser_type: '{condenser_type}'
            cooling_capacity_function_of_temperature_curve_name: '{} RecipCapFT' # required by schema
            electric_input_to_cooling_output_ratio_function_of_part_load_ratio_curve_name: '{} RecipEIRFPLR' # required by schema
            electric_input_to_cooling_output_ratio_function_of_temperature_curve_name: '{} RecipEIRFT' # required by schema
            leaving_chilled_water_lower_temperature_limit: 5 # set by template, not object default
            minimum_part_load_ratio: 0.0 # template default, not object default
            minimum_unloading_ratio: 0.25 # template default, not object default
            maximum_part_load_ratio: '{maximum_part_load_ratio}'
            optimum_part_load_ratio: 1.0 # template default, # todo_eo: object default but comparison fails unless explicitly entered
            reference_capacity: '{capacity}' # required in template
            reference_cop: '{nominal_cop}' # required in template
            reference_chilled_water_flow_rate: Autosize # set by legacy, not reachable by template, no default
            reference_condenser_fluid_flow_rate: Autosize # set by legacy, not reachable by template, no default
            sizing_factor: '{sizing_factor}'
  Coil:
    Cooling:
      Common:
        Objects: &CoilCoolingCommonObjects
          - Branch:
              name: '{} Cooling Coil Chw Branch'
              components:
                - component_inlet_node_name:
                    ^Coil:Cooling:Water($|:DetailedGeometry)+: water_inlet_node_name
                  component_name:
                    ^Coil:Cooling:Water($|:DetailedGeometry)+: key
                  component_object_type:
                    ^Coil:Cooling:Water($|:DetailedGeometry)+: self
                  component_outlet_node_name:
                    ^Coil:Cooling:Water($|:DetailedGeometry)+: water_outlet_node_name
        Transitions: &CoilCoolingCommonTransitions
          - ^Coil:Cooling:Water($|:DetailedGeometry)+:
              cooling_coil_availability_schedule_name: availability_schedule_name
      Base:
        Fields: &CoilCoolingFields
          name: '{} Cooling Coil'
          air_inlet_node_name: '{} Cooling Coil Inlet' # required by schema
          air_outlet_node_name: '{} Cooling Coil Outlet' # required by schema
        Water:
          Fields: &CoilCoolingWaterFields
            <<: *CoilCoolingFields
            heat_exchanger_configuration: CrossFlow # set by legacy, not reachable by template, no default
            type_of_analysis: DetailedAnalysis # set by legacy, not reachable by template, not default
            water_inlet_node_name: '{} Cooling Coil Chw Inlet' # required by schema
            water_outlet_node_name: '{} Cooling Coil Chw Outlet' # required by schema
          Connectors: &CoilCoolingWaterConnectors
            AirLoop: *ConnectorsAirLoop
            ChilledWaterLoop: *ConnectorsWaterLoop
          DetailedGeometry:
            Fields:
              << : *CoilCoolingWaterFields
            Connectors:
              << : *CoilCoolingWaterConnectors
    Heating:
      Common:
        Objects: &CoilHeatingCommonObjects
          - Branch: &CoilHeatingBranch
              name: '{} Heating Coil Hw Branch'
              components:
                - component_inlet_node_name:
                    Coil:Heating:Water: water_inlet_node_name
                  component_name:
                    Coil:Heating:Water: key
                  component_object_type:
                    Coil:Heating:Water: self
                  component_outlet_node_name:
                    Coil:Heating:Water: water_outlet_node_name
        Transitions: &CoilHeatingCommonTransitions
          - ^Coil:Cooling:Heating.*:
              heating_coil_availability_schedule_name: availability_schedule_name
      Base:
        Fields: &CoilHeatingFields
          name: '{} Heating Coil'
          air_inlet_node_name: '{} Heating Coil Inlet' # required by schema
          air_outlet_node_name: '{} Heating Coil Outlet' # required by schema
        Connectors:
          AirLoop: *ConnectorsAirLoop
        Water:
          Fields: &CoilHeatingWaterFields
            << : *CoilHeatingFields
            water_inlet_node_name: '{} Heating Coil Hw Inlet' # required by schema
            water_outlet_node_name: '{} Heating Coil Hw Outlet' # required by schema
            rated_inlet_air_temperature: 16.6 # set by legacy, default but simulations unstable when omitted
            rated_inlet_water_temperature: 82.2 # set by legacy, default but simulations unstable when omitted
            rated_outlet_air_temperature: 32.2 # set by legacy, default but simulations unstable when omitted
            rated_outlet_water_temperature: 71.1 # set by legacy, default but simulations unstable when omitted
          Connectors: &CoilHeatingWaterConnectors
            AirLoop: *ConnectorsAirLoop
            HotWaterLoop: *ConnectorsWaterLoop
  Controller:
    OutdoorAir:
      Base:
        Fields: &ControllerOutdoorAir
          name: '{} OA Controller'
          actuator_node_name: # required by schema
            OutdoorAir:Mixer: outdoor_air_stream_node_name
          economizer_control_type: '{economizer_type}'
          economizer_maximum_limit_dewpoint_temperature: '{economizer_maximum_limit_dewpoint_temperature}'
          economizer_maximum_limit_dry_bulb_temperature: '{economizer_upper_temperature_limit}'
          economizer_minimum_limit_dry_bulb_temperature: '{economizer_lower_temperature_limit}'
          economizer_maximum_limit_enthalpy: '{economizer_upper_enthalpy_limit}'
          maximum_outdoor_air_flow_rate: Autosize # template default, required by schema
          minimum_limit_type: '{minimum_outdoor_air_control_type}'
          minimum_outdoor_air_flow_rate: Autosize # template default, required by schema
          minimum_outdoor_air_schedule_name: '{minimum_outdoor_air_schedule_name}'
          mixed_air_node_name: # required by schema
            OutdoorAir:Mixer: mixed_air_node_name
          relief_air_outlet_node_name: # required by schema
            OutdoorAir:Mixer: relief_air_stream_node_name
          return_air_node_name: # required by schema
            OutdoorAir:Mixer: return_air_stream_node_name
    WaterCoil:
      Base:
        Fields: &ControllerWaterCoil
          name: '{} Coil Controller'
          control_variable: Temperature # set by legacy, not reachable from template, no default
          actuator_variable: Flow # set by legacy, not reachable from template, no default
          minimum_actuated_flow: 0 # set by legacy, not reachable from template, default value unstable unless entered..
          sensor_node_name: # required by schema
            ^Coil:(Cooling|Heating):Water.*: air_outlet_node_name
          actuator_node_name: # required by schema
            ^Coil:(Cooling|Heating):Water.*: water_inlet_node_name
  CondenserEquipmentOperationSchemes:
    CondenserLoad:
      Base:
        Fields: &CondenserEquipmentOperationSchemesCondenserLoad
          name: *PlantEquipmentOperationScheme
          control_scheme_1_name: # required by schema
            PlantEquipmentOperation:.*: key
          control_scheme_1_object_type: # required by schema
            PlantEquipmentOperation:.*: self
          control_scheme_1_schedule_name: HVACTemplate-Always1 # required by schema, no default # todo_eo: might be set via template
  CondenserLoop:
    Base:
      Fields: &CondenserLoopFields
        name: *PlantLoop
        condenser_demand_side_branch_list_name: *DemandSideBranches # required by schema
        condenser_demand_side_connector_list_name: *DemandSideConnectors # required by schema
        condenser_equipment_operation_scheme_name: *PlantEquipmentOperationScheme # required by schema
        condenser_loop_temperature_setpoint_node_name: *SupplyOutlet # required by schema
        condenser_side_branch_list_name: *SupplySideBranches # required by schema
        condenser_side_connector_list_name: *SupplySideConnectors # required by schema
        condenser_side_inlet_node_name: *SupplyInlet # required by schema
        condenser_side_outlet_node_name: *SupplyOutlet # required by schema
        demand_side_inlet_node_name: *DemandInlet # required by schema
        demand_side_outlet_node_name: *DemandOutlet # required by schema
        load_distribution_scheme: SequentialLoad # default but warning is issued when missing
        maximum_loop_flow_rate: Autosize # set by legacy, not reachable from template, no default
        maximum_loop_temperature: 80 # set by legacy, not reachable from template, no default
        minimum_loop_temperature: 5 # set by legacy, not reachable from template, no default
  CoolingTower:
    Common:
      Objects: &CoolingTowerCommonObjects
        - Branch:
            name: '{} Branch'
            components:
              - component_object_type:
                  CoolingTower.*: self
                component_name:
                  CoolingTower.*: key
                component_inlet_node_name:
                  CoolingTower*: water_inlet_node_name
                component_outlet_node_name:
                  CoolingTower.*: water_outlet_node_name
    SingleSpeed:
      Base:
        Fields: &CoolingTowerSingleSpeed
          name: '{}'
          blowdown_calculation_mode: ConcentrationRatio # set by legacy, not reachable from template, no default
          design_air_flow_rate: Autosize # set by legacy, not reachable from template, no default, required by schema
          design_fan_power: Autosize # set by legacy, not reachable from template, no default, required by schema
          design_u_factor_times_area_value: Autosize # set by legacy, not reachable from template, no default
          design_water_flow_rate: Autosize # set by legacy, not reachable from template, no default
          evaporation_loss_mode: SaturatedExit # set by legacy, not reachable from template, no default
          free_convection_capacity: Autocalculate # set by legacy, not reachable from template, no default
          free_convection_regime_air_flow_rate: Autocalculate # set by legacy, not reachable from template, not default
          free_convection_regime_u_factor_times_area_value: Autocalculate # set by legacy, not reachable from template, not default
          outdoor_air_inlet_node_name: *OutdoorAirInletNodes
          sizing_factor: '{sizing_factor}'
          water_inlet_node_name: '{} Inlet' # required by schema
          water_outlet_node_name: '{} Outlet' # required by schema
  DesignSpecification:
    OutdoorAir:
      Base:
        Fields: &DesignSpecificationOutdoorAir
          name: '{} SZ DSOA'
          outdoor_air_method: '{outdoor_air_method}'
          outdoor_air_flow_per_person: '{outdoor_air_flow_rate_per_person}'
          outdoor_air_flow_per_zone_floor_area: '{outdoor_air_flow_rate_per_zone_floor_area}'
          outdoor_air_flow_per_zone: '{outdoor_air_flow_rate_per_zone}'
    ZoneAirDistribution:
      Base:
        Fields: &DesignSpecificationZoneAirDistribution
          name: '{} SZ DSZAD'
  Fan:
    Common:
      Mappings:
        VariableVolum:
          CommonMappings: &FanCommonMappingsVariableVolume
            - Fan:.*:
                supply_fan_part_load_power_coefficients:
                  InletVaneDampers: &FanVariableVolumeSupplyPLRCoefficients
                    fan_power_coefficient_1: 0.35071223
                    fan_power_coefficient_2: 0.30850535
                    fan_power_coefficient_3: -0.54137364
                    fan_power_coefficient_4: 0.87198823
                    fan_power_coefficient_5: 0
                    fan_power_minimum_flow_fraction: 0.25
                    fan_power_minimum_flow_rate_input_method: Fraction
                return_fan_part_load_power_coefficients:
                  InletVaneDampers:
                    <<: *FanVariableVolumeSupplyPLRCoefficients
                    fan_power_minimum_flow_fraction: 0
      Transitions:
        SystemModel: &FanCommonTransitionsSystemModel
          - Fan:.*:
              supply_fan_delta_pressure: design_pressure_rise
              supply_fan_motor_efficiency: motor_efficiency
              supply_fan_total_efficiency: fan_total_efficiency
              supply_fan_motor_airstream_fraction: motor_in_airstream_fraction
        Supply: &FanCommonTransitionsSupply
          - Fan:.*:
              supply_fan_delta_pressure: pressure_rise
              supply_fan_maximum_flow_rate: maximum_flow_rate
              supply_fan_motor_airstream_fraction: motor_in_airstream_fraction
              supply_fan_motor_efficiency: motor_efficiency
              supply_fan_total_efficiency: fan_total_efficiency
        Return: &FanCommonTransitionsReturn
          - Fan:.*:
              return_fan_delta_pressure: pressure_rise
              return_fan_maximum_flow_rate: maximum_flow_rate
              return_fan_motor_airstream_fraction: motor_in_airstream_fraction
              return_fan_motor_efficiency: motor_efficiency
              return_fan_total_efficiency: fan_total_efficiency
    Base:
      Fields: &FanFields
        name: '{} Supply Fan'
        air_inlet_node_name: '{} Supply Fan Inlet' # required by schema
        air_outlet_node_name: '{} Supply Fan Outlet' # required by schema
        availability_schedule_name: '{system_availability_schedule_name}'
#        fan_power_minimum_flow_rate: # todo_eo: autosize is specified in template but only numbers allowed
        motor_in_airstream_fraction: 1.0 # set by template
      Connectors: &FanConnectors
        AirLoop: *ConnectorsAirLoop
    ConstantVolume:
      Base: &FanConstantVolumeSuperObject
        Fields:
          << : *FanFields
          maximum_flow_rate: Autosize
          pressure_rise: 600
        Connectors: *FanConnectors
    SystemModel:
      Base:
        Fields: &FanSystemModelFields
          <<: *FanFields
          design_maximum_air_flow_rate: '{supply_air_maximum_flow_rate}' # required by schema
          design_power_sizing_method: TotalEfficiencyAndPressure # set by legacy, not reachable by template, not default
          electric_power_minimum_flow_rate_fraction: 0 # set by legacy, not reachable by template, not default
        Connectors: *FanConnectors
    VariableVolume:
      Base: &FanVariableVolumeSuperObject
        Fields: &FanVariableVolumeFields
          << : *FanFields
          maximum_flow_rate: Autosize
        Connectors: &FanVariableVolumeConnectors
          << : *FanConnectors
          pressure_rise: 1000 # set by HVACTemplate:System:VAV template
  OutdoorAir:
    Base:
      Mixer: &OutdoorAirMixerSuperObject
        Fields: &OutdoorAirMixerFields
          name: '{} OA Mixing Box' # required by schema
          mixed_air_node_name: '{} Mixed Air Outlet' # required by schema
          outdoor_air_stream_node_name: '{} Outside Air Inlet' # required by schema
          relief_air_stream_node_name: '{} Relief Air Outlet' # required by schema
          return_air_stream_node_name: *AirLoopInlet # required by schema
        Connectors: &OutdooAirMixerConnectors
          AirLoop:
            Inlet: return_air_stream_node_name
            Outlet: mixed_air_node_name
    NodeList:
      Base:
        Fields: &OutdoorAirNodeListFields
          name: '{} Outdoor Air NodeList'
          nodes:
            - node_or_nodelist_name:
                OutdoorAir:Mixer: outdoor_air_stream_node_name # BuildPathReference not used since node isn't connector
  PlantLoop:
    Base:
      Fields: &PlantLoopFields
        name: *PlantLoop
        demand_side_branch_list_name: *DemandSideBranches # required by schema
        demand_side_connector_list_name: *DemandSideConnectors
        demand_side_inlet_node_name: *DemandInlet # required by schema
        demand_side_outlet_node_name: *DemandOutlet # required by schema
        load_distribution_scheme: SequentialLoad # todo_eo: default indicated but causes warning when missing
        loop_temperature_setpoint_node_name: *SupplyOutlet # required by schema
        maximum_loop_flow_rate: Autosize # set by legacy, not reachable from template, no default
        plant_equipment_operation_scheme_name: *PlantEquipmentOperationScheme # required by schema
        plant_side_branch_list_name: *SupplySideBranches # required by schema
        plant_side_connector_list_name: *SupplySideConnectors
        plant_side_inlet_node_name: *SupplyInlet # required by schema
        plant_side_outlet_node_name: *SupplyOutlet # required by schema
    ChilledWater: &PlantLoopChilledWaterFields
      <<: *PlantLoopFields
      availability_manager_list_name: *AvailabilityManagerList
      maximum_loop_temperature: 98 # set by legacy, not reachable from template, no default, required by schema
      minimum_loop_temperature: 1 # set by legacy, not reachable from template, no default, required by schema
    HotWater: &PlantLoopHotWaterFields
      <<: *PlantLoopFields
      maximum_loop_temperature: 100 # set by legacy, not reachable from template, no default, required by schema
      minimum_loop_temperature: 10 # set by legacy, not reachable from template, no default, required by schema
  PlantEquipmentOperation:
    CoolingLoad:
      ChilledWater:
        Base:
          Fields: &PlantEquipmentOperationCoolingLoadChilledWater
            name: *PlantEquipmentOperation
            load_range_1_lower_limit: 0 # set by legacy, not reachable from template, no default, required by schema
            load_range_1_upper_limit: 1000000000000000 # set by legacy, not reachable from template, no default, required by schema
            range_1_equipment_list_name: *PlantEquipmentList
      CondenserWater:
        Base:
          Fields: &PlantEquipmentOperationCoolingLoadCondenserWater
            <<: *PlantEquipmentOperationCoolingLoadChilledWater
      HotWater:
        Base:
          Fields: &PlantEquipmentOperationHeatingLoadHotWater
            <<: *PlantEquipmentOperationCoolingLoadChilledWater
  PlantEquipmentOperationSchemes:
    CoolingLoad:
      Base:
        Fields: &PlantEquipmentOperationSchemesCoolingLoad
          name: *PlantEquipmentOperationScheme
          control_scheme_1_name: # required by schema
            PlantEquipmentOperation:.*: key
          control_scheme_1_object_type: # required by schema
            PlantEquipmentOperation:.*: self
          control_scheme_1_schedule_name: HVACTemplate-Always1 # required by schema
    HeatingLoad:
      Base:
        Fields: &PlantEquipmentOperationSchemesHeatingLoad
          <<: *PlantEquipmentOperationSchemesCoolingLoad
  Pump:
    Common:
      Objects:
        - Branch: &PumpBranchVariableSpeedSupplyInlet
            name: *SupplyInletBranch
            components:
              - component_object_type: Pump:VariableSpeed # required by schema
                component_name: '{} Supply Pump' # required by schema
                component_inlet_node_name: '{} Supply Inlet' # required by schema
                component_outlet_node_name: '{} Supply Inlet Pump Outlet' # required by schema
        - Branch: &PumpBranchConstantSpeedSupplyInlet
            name: *SupplyInletBranch
            components:
              - component_object_type: Pump:ConstantSpeed # required by schema
                component_name: '{} Supply Pump' # required by schema
                component_inlet_node_name: '{} Supply Inlet' # required by schema
                component_outlet_node_name: '{} Supply Inlet Pump Outlet' # required by schema
    Base:
      Fields: &PumpFields
        name: '{} Supply Pump'
        inlet_node_name: '{} Supply Inlet' # required by schema
        outlet_node_name: '{} Supply Inlet Pump Outlet' # required by schema
        design_power_consumption: Autosize # set by legacy, not reachable from template, no default
        pump_control_type: Intermittent # set by legacy, not reachable from template, no default
      ConstantSpeed:
        Fields: &PumpConstantSpeed
          <<: *PumpFields
          design_flow_rate: Autosize # set by legacy, not reachable from template, no default
      VariableSpeed:
        Fields: &PumpVariableSpeed
          <<: *PumpFields
          design_maximum_flow_rate: Autosize # set by legacy, not reachable from template, no default
          coefficient_2_of_the_part_load_performance_curve: 0 # set by legacy, not reachable from template, no default
          coefficient_3_of_the_part_load_performance_curve: 1 # set by legacy, not reachable from template, no default
  SetpointManager:
    MixedAir:
      Base:
        Fields: &SetpointManagerMixedAir
          control_variable: Temperature
          fan_inlet_node_name: # required by schema
            BuildPathReference:
              Location: Fan:.*
              Occurrence: -1
              ValueLocation: Inlet
          fan_outlet_node_name: # required by schema
            BuildPathReference:
              Location: Fan:.*
              Occurrence: -1
              ValueLocation: Outlet
      Cooling:
        Base:
          Fields: &SetpointManagerMixedAirCooling
            <<: *SetpointManagerMixedAir
            name: '{} Cooling Coil Air Temp Manager'
            reference_setpoint_node_name: # required by schema
              BuildPathReference:
                Location: -1
                ValueLocation: Outlet
            setpoint_node_or_nodelist_name: *SystemMixedAirNodelistName # required by schema
      Heating:
        Base:
          Fields: &SetpointManagerMixedAirHeating
            <<: *SetpointManagerMixedAir
            name: '{} Heating Coil Air Temp Manager'
            reference_setpoint_node_name: *SystemSupplyPathInletName # required by schema
            setpoint_node_or_nodelist_name: # required by schema
              BuildPathReference:
                Location: Coil:Heating.*
                Occurrence: -1
                ValueLocation: Outlet
    OutdoorAirReset:
      Base:
        Fields: &SetpointManagerOutdoorAirReset
          name: '{} Temp Manager'
          control_variable: Temperature # set by legacy # todo_eo: no default, even though schema says there is.
          setpoint_node_or_nodelist_name: *SupplySetpointNodes # required by schema
    Scheduled:
      Base:
        Fields: &SetpointManagerScheduled
          <<: *SetpointManagerOutdoorAirReset
  Sizing:
    Zone:
      Common:
        Mappings: &SizingZoneCommonMappings
          - Sizing:Zone:
              zone_cooling_design_supply_air_temperature_input_method:
                SystemSupplyAirTemperature: # todo_eo: the system cooling design setpoint needs to be mapped to zone supplyairtemperature
                  zone_cooling_design_supply_air_temperature_input_method: SupplyAirTemperature
        Transitions: &SizingZoneCommonTransitions
          - Sizing:Zone:
#              constant_minimum_air_flow_fraction: cooling_minimum_air_flow_fraction # todo_eo: legacy doesn't use this
              design_specification_outdoor_air_object_name_for_sizing: design_specification_outdoor_air_object_name
              design_specification_zone_air_distribution_object_name: design_specification_zone_air_distribution_object_name
              maximum_flow_fraction_during_reheat: heating_maximum_air_flow_fraction
              zone_cooling_design_supply_air_humidity_ratio: zone_cooling_design_supply_air_humidity_ratio
              zone_cooling_design_supply_air_temperature_input_method: zone_cooling_design_supply_air_temperature_input_method
              zone_cooling_design_supply_air_temperature: zone_cooling_design_supply_air_temperature
              zone_cooling_design_supply_air_temperature_difference: zone_cooling_design_supply_air_temperature_difference
              zone_heating_design_supply_air_temperature: zone_heating_design_supply_air_temperature
              zone_cooling_sizing_factor: zone_cooling_sizing_factor
              zone_heating_sizing_factor: zone_heating_sizing_factor
      Base:
        Fields: &SizingZone
          name: '{} Sizing Zone'
          cooling_minimum_air_flow_fraction: 0 # set by legacy, no default
          heating_maximum_air_flow_fraction: 0 # set by legacy, no default
          zone_cooling_design_supply_air_humidity_ratio: 0.008 # set by legacy, not reachable from template, no default, required by schema
          zone_cooling_design_supply_air_temperature_input_method: '{zone_cooling_design_supply_air_temperature_input_method}'
          zone_cooling_design_supply_air_temperature: 12.8 # template default, no object default
          zone_cooling_design_supply_air_temperature_difference: 11.11 # template default, no object default
          zone_heating_design_supply_air_humidity_ratio: 0.008 # set by legacy, not reachable from template, no default, required by schema
          zone_heating_design_supply_air_temperature: 50.0 # template default, no object default
          zone_heating_design_supply_air_temperature_input_method: '{zone_heating_design_supply_air_temperature_input_method}'
          zone_or_zonelist_name: '{zone_name}' # required by schema, no default
          zone_heating_sizing_factor: '{zone_heating_sizing_factor}'
      WithOA:
        Fields: &SizingZoneOA
          <<: *SizingZone
          design_specification_outdoor_air_object_name:
            ^DesignSpecification:Outdoor.*: key
          # todo_eo: if this field is provided in template, it needs to be set, possibly do this for any template field.
          design_specification_zone_air_distribution_object_name:
            ^DesignSpecification:ZoneAirDistribution.*: key
          zone_cooling_sizing_factor: '{zone_cooling_sizing_factor}'
    System:
      Base:
        Fields: &SizingSystem
          name: '{} Sizing System'
          airloop_name: '{}'
          central_cooling_capacity_control_method: OnOff
          central_cooling_design_supply_air_temperature: 12.8 # set by legacy, not default, required by schema
          central_heating_design_supply_air_temperature: 10.0 # set by legacy, not default
          central_heating_maximum_system_air_flow_ratio: 0.3 # set by legacy, not default, required by schema
          design_outdoor_air_flow_rate: '{maximum_outdoor_air_flow_rate}'
          preheat_design_temperature: 7.2 # required by schema
          preheat_design_humidity_ratio: 0.008 # required by schema
          precool_design_temperature: 11 # required by schema
          precool_design_humidity_ratio: 0.008 # required by schema
          heating_design_capacity_method: HeatingDesignCapacity # todo_eo: required even though default indicated in schema
          system_outdoor_air_method: ZoneSum
          type_of_zone_sum_to_use: '{sizing_option}'
          zone_maximum_outdoor_air_fraction: 1.0
    Base:
      Fields: &SizingPlant
        name: '{} Sizing Plant'
        plant_or_condenser_loop_name: *PlantLoop
  ZoneHVAC:
    AirDistributionUnit:
      Base:
        Fields: &ZoneHVACAirDistributionUnit
          name: '{} ATU'
    Baseboard:
      RadiantConvective:
        Water:
          Common:
            Objects: &ZoneHVACBaseboardRadiantConvectiveWaterCommonObjects
              - Branch:
                  name: '{} Baseboard Heat Hw Branch'
                  components:
                    - component_inlet_node_name:
                        ZoneHVAC:Baseboard:RadiantConvective:Water: inlet_node_name
                      component_name:
                        ZoneHVAC:Baseboard:RadiantConvective:Water: key
                      component_object_type:
                        ZoneHVAC:Baseboard:RadiantConvective:Water: self
                      component_outlet_node_name:
                        ZoneHVAC:Baseboard:RadiantConvective:Water: outlet_node_name
            Transitions: &ZoneHVACBaseboardRadiantConvectiveWaterCommonTransitions
              - ZoneHVAC:Baseboard:RadiantConvective:Water:
                  baseboard_heating_capacity: heating_design_capacity
          Base:
            Fields: &ZoneHVACBaseboardRadiantConvectiveWaterFields
              name: '{} Baseboard Heat'
              availability_schedule_name: '{system_availability_schedule_name}'
              fraction_of_radiant_energy_incident_on_people: 0.0 # set by legacy, no object default, not reachable from template
              fraction_radiant: 0.0 # set by legacy, no object default, not reachable from template, required by schema
              heating_design_capacity: Autosize # todo_eo template default, no object default
              heating_design_capacity_method: HeatingDesignCapacity # todo_eo: object default, but error unless specified
              inlet_node_name: '{} Baseboard HW Inlet'
              maximum_water_flow_rate: Autosize # set by legacy, no object default, not reachable from template, required by schema
              outlet_node_name: '{} Baseboard HW Outlet'
    EquipmentList:
      Base:
        Fields: &ZoneHVACEquipmentList
          name: '{} Equipment'
    EquipmentConnections:
      Base:
        Fields: &ZoneHVACEquipmentConnectionsFields
          name: '{} Equipment Connections'
          zone_air_node_name: '{} Zone Air Node' # required by schema
          zone_conditioning_equipment_list_name: # required by schema
            ZoneHVAC:EquipmentList: key
          zone_name: '{zone_name}' # required by schema
          zone_return_air_node_or_nodelist_name: *ZoneReturnOutlet
      Air:
        Fields: &ZoneHVACEquipmentConnectionsFieldsAir
          <<: *ZoneHVACEquipmentConnectionsFields
          zone_air_inlet_node_or_nodelist_name: *ZoneSupplyInlet # It might be a good idea to just use the same name for zone and system
    FourPipeFanCoil:
      Common:
        Transitions: &ZoneHVACFourPipeFanCoilCommonTransitions
          - ZoneHVAC:FourPipeFanCoil:
              supply_air_maximum_flow_rate: maximum_supply_air_flow_rate
      Base:
        Fields: &ZoneHVACFourPipeFanCoil
          name: '{} Fan Coil'
          air_inlet_node_name: *ZoneReturn
          air_outlet_node_name: *ZoneSupplyInlet
          availability_schedule_name: '{system_availability_schedule_name}'
          capacity_control_method: ConstantFanVariableFlow # set by legacy, no default
          maximum_cold_water_flow_rate: Autosize # set by legacy, not reachable from template, no object default, required by schema
          maximum_hot_water_flow_rate: Autosize # set by legacy, not reachable from template, no object default, required by schema
          maximum_outdoor_air_flow_rate: Autosize # set by legacy, unreachable from template, required by schema
          maximum_supply_air_flow_rate: Autosize # set by template default, no object default, required by schema
          outdoor_air_mixer_name:
            BuildPathReference:
              Location: OutdoorAir:Mixer
              Occurrence: -1
              ValueLocation: key
          outdoor_air_mixer_object_type:
            BuildPathReference:
              Location: OutdoorAir:Mixer
              Occurrence: -1
              ValueLocation: self
          supply_air_fan_name:
            BuildPathReference:
              Location: Fan:.*
              Occurrence: -1
              ValueLocation: key
          supply_air_fan_object_type:
            BuildPathReference:
              Location: Fan:.*
              Occurrence: -1
              ValueLocation: self
          cooling_coil_object_type:
            BuildPathReference:
              Location: Coil:Cooling:Water.*
              ValueLocation: self
          cooling_coil_name:
            BuildPathReference:
              Location: Coil:Cooling:Water.*
              ValueLocation: key
          heating_coil_object_type:
            BuildPathReference:
              Location: Coil:Heating:Water.*
              ValueLocation: self
          heating_coil_name:
            BuildPathReference:
              Location: Coil:Heating:Water.*
              ValueLocation: key

AutoCreated:
  PlantLoop:
    BranchList:
      Demand:
        name: *DemandSideBranches
        branches:
          - branch_name: *DemandInletBranch
          - branch_name: *DemandBypassBranch
          - branch_name: *DemandOutletBranch
      Supply:
        name: *SupplySideBranches
        branches:
          - branch_name: *SupplyInletBranch
          - branch_name: *SupplyBypassBranch
          - branch_name: *SupplyOutletBranch
    CondenserEquipmentList:
      name: *CondenserEquipmentList
    Connector:
      Mixer:
        Demand:
          name: *DemandMixer
          outlet_branch_name: *DemandOutletBranch
          branches:
            - inlet_branch_name: *DemandBypassBranch
        Supply:
          name: *SupplyMixer
          outlet_branch_name: *SupplyOutletBranch
          branches:
            - inlet_branch_name: *SupplyBypassBranch
      Splitter:
        Demand:
          name: *DemandSplitter
          inlet_branch_name: *DemandInletBranch
          branches:
            - outlet_branch_name: *DemandBypassBranch
        Supply:
          name: *SupplySplitter
          inlet_branch_name: *SupplyInletBranch
          branches:
            - outlet_branch_name: *SupplyBypassBranch
    ConnectorList:
      Demand:
        name: *DemandSideConnectors
        connector_1_object_type: Connector:Splitter
        connector_1_name: *DemandSplitter
        connector_2_object_type: Connector:Mixer
        connector_2_name: *DemandMixer
      Supply:
        name: *SupplySideConnectors
        connector_1_object_type: Connector:Splitter
        connector_1_name: *SupplySplitter
        connector_2_object_type: Connector:Mixer
        connector_2_name: *SupplyMixer
    NodeList:
      Supply:
        name: *SupplySetpointNodes
        nodes:
          - node_name: *SupplyOutlet
    PlantEquipmentList:
      name: *PlantEquipmentList
  System:
    AirLoopHVAC:
      ControllerList:
        WaterCoil:
          Base:
            name: *AirLoopHVACWaterControllers
        OutdoorAir:
          Base:
            name: '{} OA Controllers'
      OutdoorAirSystem:
        Base:
          name: '{} OA System'
        EquipmentList:
          Base:
            name: '{} OA System Equipment'
      ReturnPath:
        Base:
          name: '{} Return Path'
          return_air_path_outlet_node_name:
            ^AirLoopHVAC:(ZoneMixer|ReturnPlenum): outlet_node_name
          components:
            - component_object_type:
                ^AirLoopHVAC:(ZoneMixer|ReturnPlenum): self
              component_name:
                ^AirLoopHVAC:(ZoneMixer|ReturnPlenum): key
      ReturnPlenum:
        Base:
          name: '{} Return Plenum'
          outlet_node_name: *ReturnAirOutlet
          zone_name: '{return_plenum_name}'
          zone_node_name: '{return_plenum_name} Zone Air Node'
      SupplyPath:
        Base:
          name: '{} Supply Path'
          supply_air_path_inlet_node_name:
            ^AirLoopHVAC:(ZoneSplitter|SupplyPlenum): inlet_node_name
          components:
            - component_object_type:
                ^AirLoopHVAC:(ZoneSplitter|SupplyPlenum): self
              component_name:
                ^AirLoopHVAC:(ZoneSplitter|SupplyPlenum): key
      SupplyPlenum:
        Base:
          name: '{} Supply Plenum'
          inlet_node_name: *SystemSupplyPathInletName
          zone_name: '{supply_plenum_name}'
          zone_node_name: '{supply_plenum_name} Zone Air Node'
      ZoneMixer:
        Base:
          name: '{} Zone Mixer'
          outlet_node_name: *ReturnAirOutlet
      ZoneSplitter:
        Base:
          name: '{} Zone Splitter'
          inlet_node_name: *SystemSupplyPathInletName
    AvailabilityManagerAssignmentList:
      Base:
        name: *AvailabilityManagerAssignmentList
    Branch:
      Base:
        name: '{} Main Branch'
    BranchList:
      Base:
        name: '{} Branches'
        branches:
          - branch_name: '{} Main Branch'

OptionTree:
  HVACTemplate:
    Zone:
      Common:
        Objects:
          Base: &ZoneCommonObjects
            - DesignSpecification:OutdoorAir: *DesignSpecificationOutdoorAir
            - DesignSpecification:ZoneAirDistribution: *DesignSpecificationZoneAirDistribution
            - Sizing:Zone: *SizingZoneOA
            - ZoneHVAC:EquipmentList:
                <<: *ZoneHVACEquipmentList
                equipment:
                  - zone_equipment_object_type:
                      ^ZoneHVAC:(AirDistribution|FourPipe).*: self
                    zone_equipment_name:
                      ^ZoneHVAC:(AirDistribution|FourPipe).*: key
                    zone_equipment_cooling_sequence: 1
                    zone_equipment_heating_or_no_load_sequence: 1
          AirTerminal: &ZoneCommonObjectsAirTerminal
            - *ZoneCommonObjects
            - ZoneHVAC:EquipmentConnections: *ZoneHVACEquipmentConnectionsFieldsAir
            - ZoneHVAC:AirDistributionUnit:
                <<: *ZoneHVACAirDistributionUnit
                air_distribution_unit_outlet_node_name:
                  ^AirTerminal:.*: air_outlet_node_name
                air_terminal_object_type:
                  ^AirTerminal:.*: self
                air_terminal_name:
                  ^AirTerminal:.*: key
      BaseboardHeat:
        BaseObjects:
        TemplateObjects:
          baseboard_heating_type:
            HotWater:
              Objects: # Common object not used since baseboards do not use air paths and are also
                       #   secondary equipment in some options.
                - Sizing:Zone: *SizingZone
                - ZoneHVAC:Baseboard:RadiantConvective:Water: *ZoneHVACBaseboardRadiantConvectiveWaterFields
                - *ZoneHVACBaseboardRadiantConvectiveWaterCommonObjects
                - ZoneHVAC:EquipmentConnections: *ZoneHVACEquipmentConnectionsFields
                - ZoneHVAC:EquipmentList:
                    <<: *ZoneHVACEquipmentList
                    equipment:
                      - zone_equipment_object_type:
                          ^ZoneHVAC:Baseboard.*: self
                        zone_equipment_name:
                          ^ZoneHVAC:Baseboard.*: key
                        zone_equipment_cooling_sequence: 1
                        zone_equipment_heating_or_no_load_sequence: 1
              Transitions:
                - *ZoneHVACBaseboardRadiantConvectiveWaterCommonTransitions
      ConstantVolume:
        BaseObjects:
          Objects:
            - *ZoneCommonObjectsAirTerminal
          Transitions: *SizingZoneCommonTransitions
          Mappings: *SizingZoneCommonMappings
      FanCoil:
        BuildPath:
          BaseObjects:
            Objects:
              - OutdoorAir:Mixer:
                  Fields:
                    <<: *OutdoorAirMixerFields
                    return_air_stream_node_name: *ZoneReturn
                  Connectors: *OutdooAirMixerConnectors
              - OutdoorAir:NodeList: *OutdoorAirNodeListFields
              - Fan:SystemModel:
                  Fields: *FanSystemModelFields
                  Connectors: *FanConnectors
              - Coil:Cooling:Water:
                  Fields: *CoilCoolingWaterFields
                  Connectors: *CoilCoolingWaterConnectors
              - *CoilCoolingCommonObjects
              - Coil:Heating:Water:
                  Fields:
                    <<: *CoilHeatingWaterFields
                    air_outlet_node_name: *ZoneSupplyInlet
                  Connectors: *CoilHeatingWaterConnectors
              - *CoilHeatingCommonObjects
            Transitions:
              - *FanCommonTransitionsSystemModel
              - *ZoneHVACFourPipeFanCoilCommonTransitions
              - *CoilCoolingCommonTransitions
              - *CoilHeatingCommonTransitions
        BaseObjects:
          Objects:
            - *ZoneCommonObjects
            - ZoneHVAC:EquipmentConnections:
                <<: *ZoneHVACEquipmentConnectionsFields
                zone_air_exhaust_node_or_nodelist_name: *ZoneReturn
                zone_air_inlet_node_or_nodelist_name: *ZoneSupplyInlet
            - ZoneHVAC:FourPipeFanCoil: *ZoneHVACFourPipeFanCoil
          Transitions: *SizingZoneCommonTransitions
      VAV:
        BaseObjects:
          Objects:
            - *ZoneCommonObjectsAirTerminal
          Transitions: *SizingZoneCommonTransitions
          Mappings: *SizingZoneCommonMappings
        TemplateObjects:
          reheat_coil_type:
            HotWater:
              Objects:
                - *AirTerminalSingleDuctVAVReheatHotWater
                - Coil:Heating:Water:
                    <<: *CoilHeatingWaterFields
                    name: '{} Reheat Coil'
                    air_inlet_node_name: '{} Damper Outlet'
                    air_outlet_node_name: '{} Supply Inlet'
                    availability_schedule_name: '{reheat_coil_availability_schedule_name}'
                - Branch:
                    <<: *CoilHeatingBranch
                    name: '{} Reheat Coil Hw Branch' # todo_eo: Is this renaming necessary
              Transitions:
                - *AirTerminalCommonTransitions
    System:
      Common:
        BuildPath:
          Objects: &SystemCommonBuildPathObjects
            - OutdoorAir:Mixer: *OutdoorAirMixerSuperObject
          Actions:
            Base: &SystemCommonBuildPathActions
              - heating_coil_type:
                  HotWater:
                    ObjectReference: OutdoorAir:Mixer
                    Location: After
                    ActionType: Insert
                    Objects:
                      - Coil:Heating:Water:
                          Fields: *CoilHeatingWaterFields
                          Connectors: *CoilHeatingWaterConnectors
                      - Controller:WaterCoil:
                          <<: *ControllerWaterCoil
                          name: '{} Heating Coil Controller'
                      - *CoilHeatingCommonObjects
              - cooling_coil_type:
                  ChilledWater:
                    ObjectReference: OutdoorAir:Mixer
                    Location: After
                    ActionType: Insert
                    Objects:
                      - *CoilCoolingCommonObjects
                      - Coil:Cooling:Water:
                          Fields: *CoilCoolingWaterFields
                          Connectors: *CoilCoolingWaterConnectors
                      - Controller:WaterCoil:
                          <<: *ControllerWaterCoil
                          name: '{} Cooling Coil Controller'
            VariableVolume: &SystemCommonBuildPathActionsVariableVolume
              - supply_fan_placement:
                  (DrawThrough|None):
                    Location: -1
                    ActionType: Insert
                    Objects:
                      - Fan:VariableVolume: *FanVariableVolumeSuperObject
                    Transitions: *FanCommonTransitionsSupply
                    Mappings: *FanCommonMappingsVariableVolume
                  BlowThrough:
                    ObjectReference: OutdoorAir:Mixer
                    ActionType: Insert
                    Location: After
                    Objects:
                      - Fan:VariableVolume: *FanVariableVolumeSuperObject
                    Transitions: *FanCommonTransitionsSupply
                    Mappings: *FanCommonMappingsVariableVolume
              - return_fan:
                  'Yes': # Quotes necessary to prevent boolean conversion
                    Location: 0
                    ActionType: Insert
                    Objects:
                      - Fan:VariableVolume:
                          Fields:
                            <<: *FanVariableVolumeFields
                            name: '{} Return Fan'
                            air_inlet_node_name: *AirLoopInlet
                            air_outlet_node_name: '{} Return Fan Outlet'
                            pressure_rise: 500 # override base fan default
                          Connectors: *FanVariableVolumeConnectors
                    Transitions: *FanCommonTransitionsReturn
                    Mappings: *FanCommonMappingsVariableVolume
            ConstantVolume: &SystemCommonBuildPathActionsConstantVolume
              - supply_fan_placement:
                  (DrawThrough|None):
                    Location: -1
                    ActionType: Insert
                    Objects:
                      - Fan:ConstantVolume: *FanConstantVolumeSuperObject
                    Transitions: *FanCommonTransitionsSupply
                    Mappings: *FanCommonMappingsVariableVolume
                  BlowThrough:
                    ObjectReference: OutdoorAir:Mixer
                    ActionType: Insert
                    Location: After
                    Objects:
                      - Fan:ConstantVolume: *FanConstantVolumeSuperObject
                    Transitions: *FanCommonTransitionsSupply
                    Mappings: *FanCommonMappingsVariableVolume
              - return_fan:
                  'Yes': # Quotes necessary to prevent boolean conversion
                    Location: 0
                    ActionType: Insert
                    Objects:
                      - Fan:VariableVolume:
                          Fields:
                            <<: *FanVariableVolumeFields
                            name: '{} Return Fan'
                            air_inlet_node_name: *AirLoopInlet
                            air_outlet_node_name: '{} Return Fan Outlet'
                            pressure_rise: 500 # override base fan default
                          Connectors: *FanVariableVolumeConnectors
                    Transitions: *FanCommonTransitionsReturn
        Transitions:
          Base: &SystemCommonTransitions
            - Controller:OutdoorAir:
                economizer_lockout: lockout_type
                economizer_type: economizer_control_type
                maximum_outdoor_air_flow_rate: maximum_outdoor_air_flow_rate
                minimum_outdoor_air_flow_rate: minimum_outdoor_air_flow_rate
      ConstantVolume:
        BuildPath:
          BaseObjects:
            Objects: *SystemCommonBuildPathObjects
          Actions:
            - *SystemCommonBuildPathActions
            - *SystemCommonBuildPathActionsConstantVolume
      VAV:
        BuildPath:
          BaseObjects:
            Objects: *SystemCommonBuildPathObjects
          Actions:
            - *SystemCommonBuildPathActions
            - *SystemCommonBuildPathActionsVariableVolume
        BaseObjects:
          Objects:
            - AvailabilityManager:NightCycle:
                <<: *AvailabilityManagerNightCycle
            - OutdoorAir:NodeList: *OutdoorAirNodeListFields
            - Controller:OutdoorAir:
                <<: *ControllerOutdoorAir
                economizer_minimum_limit_dry_bulb_temperature: '{economizer_lower_temperature_limit}'
                economizer_maximum_limit_dry_bulb_temperature: '{economizer_upper_temperature_limit}'
            - SetpointManager:Scheduled:
                <<: *SetpointManagerScheduled
                name: '{} Cooling Supply Air Temp Manager'
                setpoint_node_or_nodelist_name:
                  BuildPathReference:
                    Location: -1
                    ValueLocation: Outlet
                schedule_name: 'HVACTemplate-Always{cooling_coil_design_setpoint}'
            - SetpointManager:Scheduled:
                <<: *SetpointManagerScheduled
                name: '{} Heating Supply Air Temp Manager'
                setpoint_node_or_nodelist_name: *SystemSupplyPathInletName
                schedule_name: 'HVACTemplate-Always{heating_coil_design_setpoint}'
            - SetpointManager:MixedAir:
                <<: *SetpointManagerMixedAirCooling
            - SetpointManager:MixedAir:
                <<: *SetpointManagerMixedAirHeating
            - NodeList:
                name: *SystemMixedAirNodelistName
                nodes:
                  - node_name:
                      ^Coil:Cooling:.*: air_outlet_node_name
                  - node_name:
                      ^OutdoorAir:Mixer: mixed_air_node_name
            - Sizing:System: *SizingSystem
            - AirLoopHVAC: *AirLoopHVAC
          Transitions:
            - *SystemCommonTransitions
            - ^AirloopHVAC$:
                supply_fan_maximum_flow_rate: design_supply_air_flow_rate
        TemplateObjects:
    Plant:
      Common:
        PlantLoop:
          Base: &PlantCommonPlantLoopBase
            - Pipe:Adiabatic:
                name: '{} Supply Bypass Pipe'
                inlet_node_name: '{} Supply Bypass Inlet'
                outlet_node_name: '{} Supply Bypass Outlet'
            - Branch:
                name: *SupplyBypassBranch
                components:
                  - component_object_type: Pipe:Adiabatic
                    component_name: '{} Supply Bypass Pipe'
                    component_inlet_node_name: '{} Supply Bypass Inlet'
                    component_outlet_node_name: '{} Supply Bypass Outlet'
            - Pipe:Adiabatic:
                name: '{} Supply Outlet Pipe'
                inlet_node_name: '{} Supply Outlet Pipe Inlet'
                outlet_node_name: *SupplyOutlet
            - Branch:
                name: *SupplyOutletBranch
                components:
                  - component_object_type: Pipe:Adiabatic
                    component_name: '{} Supply Outlet Pipe'
                    component_inlet_node_name: '{} Supply Outlet Pipe Inlet'
                    component_outlet_node_name: *SupplyOutlet
            - Pipe:Adiabatic:
                name: '{} Demand Bypass Pipe'
                inlet_node_name: '{} Demand Bypass Inlet'
                outlet_node_name: '{} Demand Bypass Outlet'
            - Branch:
                name: *DemandBypassBranch
                components:
                  - component_object_type: Pipe:Adiabatic
                    component_name: '{} Demand Bypass Pipe'
                    component_inlet_node_name: '{} Demand Bypass Inlet'
                    component_outlet_node_name: '{} Demand Bypass Outlet'
            - Pipe:Adiabatic:
                name: '{} Demand Outlet Pipe'
                inlet_node_name: '{} Demand Outlet Pipe Inlet'
                outlet_node_name: '{} Demand Outlet'
            - Branch:
                name: *DemandOutletBranch
                components:
                  - component_object_type: Pipe:Adiabatic
                    component_name: '{} Demand Outlet Pipe'
                    component_inlet_node_name: '{} Demand Outlet Pipe Inlet'
                    component_outlet_node_name: '{} Demand Outlet'
          PrimaryNoSecondary: &PlantCommonPlantLoopPrimaryNoSecondary
            - Pipe:Adiabatic:
                name: '{} Demand Inlet Pipe'
                inlet_node_name: *DemandInlet
                outlet_node_name: '{} Demand Inlet Pipe Outlet'
            - Branch:
                name: *DemandInletBranch
                components:
                  - component_object_type: Pipe:Adiabatic
                    component_name: '{} Demand Inlet Pipe'
                    component_inlet_node_name: *DemandInlet
                    component_outlet_node_name: '{} Demand Inlet Pipe Outlet'
          NoSecondary: &PlantCommonPlantLoopNoSecondary
            - Pipe:Adiabatic:
                name: '{} Demand Inlet Pipe'
                inlet_node_name: *DemandInlet
                outlet_node_name: '{} Demand Inlet Pipe Outlet'
            - Branch:
                name: *DemandInletBranch
                components:
                  - component_object_type: Pipe:Adiabatic
                    component_name: '{} Demand Inlet Pipe'
                    component_inlet_node_name: *DemandInlet
                    component_outlet_node_name: '{} Demand Inlet Pipe Outlet'
        ChilledWaterLoop:
          Objects: &PlantCommonObjectsChilledWaterLoop
            - AvailabilityManager:LowTemperatureTurnOff:
                name: '{} Availability Low Temp TurnOff'
                sensor_node_name: '{} Outside Air Sensor'
                temperature: '{chilled_water_design_setpoint}'
            - AvailabilityManagerAssignmentList:
                name: '{} Availability List'
                managers:
                  - availability_manager_name:
                      AvailabilityManager:LowTemperatureTurnOff: key
                    availability_manager_object_type:
                      AvailabilityManager:LowTemperatureTurnOff: self
            - SetpointManager:Scheduled:
                <<: *SetpointManagerScheduled
                schedule_name: 'HVACTemplate-Always{chilled_water_design_setpoint}'
            - OutdoorAir:Node:
                name: '{} Outside Air Sensor'
            - PlantEquipmentOperation:CoolingLoad: *PlantEquipmentOperationCoolingLoadChilledWater
            - PlantEquipmentOperationSchemes: *PlantEquipmentOperationSchemesCoolingLoad
      Boiler:
        BaseObjects:
        TemplateObjects:
          template_plant_loop_type:
            (None|HotWaterLoop):
              Objects:
                - Branch:
                    <<: *BoilerBranch
                    name: '{} Boiler HW Branch'
            MixedWaterLoop:
              Objects:
                - Branch:
                    <<: *BoilerBranch
                    name: '{} Boiler MW Branch'
          boiler_type:
            HotWaterBoiler:
              Objects:
                - Boiler:HotWater: *BoilerHotWaterFields
                - *BoilerHotWaterCommonObjects
              Transitions:
                - *BoilerHotWaterCommonTransitions
      ChilledWaterLoop:
        BaseObjects:
          Objects:
            - *PlantCommonPlantLoopBase
            - *PlantCommonObjectsChilledWaterLoop
            - Sizing:Plant:
                <<: *SizingPlant
                loop_type: Cooling
                loop_design_temperature_difference: 6.67
                design_loop_exit_temperature: '{chilled_water_design_setpoint}'
        TemplateObjects: # todo_eo: Secondary options need to have PlantLoop common_pipe_simulation changed to CommonPipe
          chilled_water_pump_configuration:
            ConstantPrimaryNoSecondary:
              Objects:
                - *PlantCommonPlantLoopPrimaryNoSecondary
                - PlantLoop:
                    <<: *PlantLoopChilledWaterFields
                - Pump:ConstantSpeed:
                    <<: *PumpConstantSpeed
                    design_pump_head: '{primary_chilled_water_pump_rated_head}'
                - Branch: *PumpBranchConstantSpeedSupplyInlet
            VariablePrimaryNoSecondary:
              Objects:
                - *PlantCommonPlantLoopPrimaryNoSecondary
                - PlantLoop:
                    <<: *PlantLoopChilledWaterFields
                - Pump:VariableSpeed:
                    <<: *PumpVariableSpeed
                    design_pump_head: '{primary_chilled_water_pump_rated_head}'
                - Branch: *PumpBranchVariableSpeedSupplyInlet
      Chiller:
        BaseObjects:
        TemplateObjects:
          chiller_type:
            ElectricReciprocatingChiller:
              Objects:
                - Chiller:Electric:EIR: *ChillerElectricEIRSuperObject
                - *ChillerElectricCommonObjects
                - *ChillerElectricEIRCommonObjects
              Transitions:
                - *ChillerElectricEIRCommonTransitions
          condenser_type:
            WaterCooled:
              Objects:
                - Branch:
                    name: '{} CndW Branch'
                    components:
                      - component_object_type:
                          Chiller.*: self
                        component_name:
                          Chiller.*: key
                        component_inlet_node_name:
                          Chiller.*: condenser_inlet_node_name
                        component_outlet_node_name:
                          Chiller.*: condenser_outlet_node_name
      CondenserWaterLoop:
        BaseObjects:
          Objects:
            - *PlantCommonPlantLoopBase
            - *PlantCommonPlantLoopNoSecondary
            - Pump:VariableSpeed:
                <<: *PumpVariableSpeed
                design_pump_head: '{condenser_water_pump_rated_head}' # template attribute set in hvac_template.py
                design_maximum_flow_rate: Autosize
                design_minimum_flow_rate: 0
            - Branch: *PumpBranchVariableSpeedSupplyInlet
            - Sizing:Plant:
                <<: *SizingPlant
                loop_type: Condenser
                loop_design_temperature_difference: 5.6
                design_loop_exit_temperature: 29.4
            - SetpointManager:Scheduled:
                <<: *SetpointManagerScheduled
                schedule_name: HVACTemplate-Always29.4
            - PlantEquipmentOperation:CoolingLoad: *PlantEquipmentOperationCoolingLoadCondenserWater
            - CondenserEquipmentOperationSchemes: *CondenserEquipmentOperationSchemesCondenserLoad
            - CondenserLoop: *CondenserLoopFields
      Tower:
        BaseObjects:
        TemplateObjects:
          tower_type:
            SingleSpeed:
              Objects:
                - CoolingTower:SingleSpeed: *CoolingTowerSingleSpeed
                - OutdoorAir:Node:
                    name: *OutdoorAirInletNodes
                - *CoolingTowerCommonObjects
      HotWaterLoop:
        BaseObjects:
          Objects:
            - *PlantCommonPlantLoopBase
            - *PlantCommonPlantLoopNoSecondary
            - Sizing:Plant:
                <<: *SizingPlant
                loop_type: Heating
                loop_design_temperature_difference: 11
                design_loop_exit_temperature: '{hot_water_design_setpoint}'
            - PlantEquipmentOperation:HeatingLoad: *PlantEquipmentOperationHeatingLoadHotWater
            - PlantEquipmentOperationSchemes: *PlantEquipmentOperationSchemesHeatingLoad
            - PlantLoop:
                <<: *PlantLoopHotWaterFields
        TemplateObjects:
          hot_water_pump_configuration:
            (None|ConstantFlow):
              Objects:
                - Pump:ConstantSpeed:
                    <<: *PumpConstantSpeed
                    design_pump_head: '{hot_water_pump_rated_head}'
                - Branch: *PumpBranchConstantSpeedSupplyInlet
            VariableFlow:
              Objects:
                - Pump:VariableSpeed:
                    <<: *PumpVariableSpeed
                    design_pump_head: '{hot_water_pump_rated_head}'
                - Branch: *PumpBranchVariableSpeedSupplyInlet
          hot_water_setpoint_reset_type:
            OutdoorAirTemperatureReset:
              Objects:
                - SetpointManager:OutdoorAirReset:
                    <<: *SetpointManagerOutdoorAirReset
                    outdoor_high_temperature: '{hot_water_reset_outdoor_dry_bulb_high}' # required by schema
                    outdoor_low_temperature: '{hot_water_reset_outdoor_dry_bulb_low}' # required by schema
                    setpoint_at_outdoor_high_temperature: '{hot_water_setpoint_at_outdoor_dry_bulb_high}' # required by schema
                    setpoint_at_outdoor_low_temperature: '{hot_water_setpoint_at_outdoor_dry_bulb_low}' # required by schema
      MixedWaterLoop:

# Notes
# Compact schedules can be created on their own via specialized structure
#  - Schedule:Compact:
#      name: HVACTemplate-Always1
#      structure: CommonObjects:Schedule:Compact:ALWAYS_VAL
#      insert_values:
#        - 1
# When building option tree, Objects, Transitions, Mappings go on same level for a leaf
